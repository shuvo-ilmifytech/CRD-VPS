name: Windows CRD (Curl Fix)

on: workflow_dispatch

jobs:
  build:
    name: Start Windows CRD
    runs-on: windows-latest
    timeout-minutes: 360

    steps:
    - name: Checkout Code
      uses: actions/checkout@v4

    - name: Download CRD using Curl
      run: |
        # আমরা এখানে PowerShell এর বদলে curl ব্যবহার করছি এবং লিঙ্কটি পরিবর্তন করেছি
        curl -L -o crd.msi "https://dl.google.com/chrome-remote-desktop/chromeremotedesktop.msi"
        
    - name: Install CRD
      run: |
        Write-Host "Installing CRD..."
        Start-Process msiexec.exe -ArgumentList "/i crd.msi /qn" -Wait
        Remove-Item crd.msi

    - name: Setup CRD Authorization
      shell: powershell
      run: |
        # আপনার Secret কোড রান করা হচ্ছে
        $cmd = "${{ secrets.CRD_CODE }}"
        Invoke-Expression $cmd

    - name: Keep Session Alive
      run: |
        Write-Host "CRD is running successfully. Connect now!"
        while ($true) {
          Start-Sleep -Seconds 60
          Write-Host "Session is active..."
        }
